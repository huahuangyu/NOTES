# 计算机网络

《计算机网络（第7版）》-谢希仁

## 第1章 概述

1. 互联网有两个重要基本特点：**连通性**和**共享**。互联网（Internet）、互连网（internet）

2. **互联网**已经成为世界上最大的计算机网络。

3. 计算机网络（简称为网络）由若干**结点**（node）和连接这些结点的**链路**（link）组成。

4. Internet的前身是美国的ARPANET，采用**TCP/IP协议族**作为通信规则。

5. 在网络边缘的端系统之间的通信方式通常可以划分为两大类：**客户-服务器方式（C/S方式）**和**对等方式**（P2P方式，peer-to-peer）。客户-服务器方式在互联网上是最常用，也是传统的方式。

6. 在网络**核心**部分起特殊作用的是**路由器**，是实现**分组交换**的关键构件。路由器的作用是按**存储转发**方式进行分组交换。

7. 电路交换、报文交换、分组交换的对比：

   ![在这里插入图片描述](picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDAwMTUyMQ==,size_16,color_FFFFFF,t_70.png)

   电路交换是**面向连接**的。分组交换采用**存储转发**的技术。在发送端，先把较长的报文**划分成较短的、固定长度的数据段**。每一个数据段前面添加上**首部**构成**分组**（packet）。每个分组在互联网中**独立地选择传输路径**。

9. 计算机网络按照网络的作用范围分类：

   （1）**广域网WAN（Wide Area Network）**。**广域网**是互联网的核心部分。作用范围约为几十到几千公里。

   （2）**城域网MAN（Metropolitan Area Network）**。作用范围约为5-50公里。
   
   （3）**局域网LAN（Local Area Network）**。局限在较小的范围（如1公里左右）。
   
   （4）**个人区域网PAN（Personal Area Network）**。范围很小，大约在10米左右。

10. 计算机网络按照网络的使用者可以分为公用网（public network）和专用网（private network）。

10. 计算机网络的性能指标：速率、带宽、吞吐量、时延、时延带宽积、往返时间RTT、利用率。

  速率是计算机网络中最重要的一个性能指标，指的是数据的传送速率。速率的单位是bit/s，或kbit/s。1 kbit/s = 1000 bits/s。

  吞吐量受网络的带宽或网络的额定速率的限制。吞吐量是到底有多少数据量能够通过网络。

  时延带宽积 = 传播时延 x 带宽。

  利用率分为信道利用率和网络利用率。

11. k = 1000，K = 1024

12. 时延包括**发送时延、传播时延、处理时延、排队时延**。发送时延是主机或路由器发送数据帧所需要的时间。传播时延是电磁波在信道中传播一定的距离需要花费的时间。

13. 信道利用率过高会产生非常大的时延。

14. 国际标准化组织**ISO**于1977年提出开放系统互连基本参考模型**OSI/RM（Open Systems Interconnection Reference Model）**，简称**OSI**。

15. 为进行网络中的数据交换而建立的规则、标准或约定称为**网络协议**。网络协议主要有以下三个要素组成：**语法**、**语义**、**同步**。协议是**控制两个对等实体（或多个实体）进行通信的规则的集合**。在协议的控制下，两个对等实体间的通信使得本层能够向上一层提供服务。**要实现本层协议，还需要使用下一层所提供的服务**。协议是“**水平的**”，服务是“**垂直的**”。

    各层完成的主要功能：①差错控制；②流量控制；③分段和重装；④复用和分用；⑤连接建立和释放。

16. 计算机网络体系结构

    <img src="https://img-blog.csdn.net/20180508083811597?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L2I5eF9f/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" style="zoom: 33%;" />

17. 传输控制协议 TCP（Transmission Control Protocol）- 提供面向连接的、可靠的数据传输服务，其数据传输的单位是报文段（segment）。

    用户数据报协议 UDP（User Datagram Protocol）- 提供无连接的、尽最大努力的数据传输服务（不保证数据阐述的可靠性），其数据传输的单位是用户数据报。

18. OSI参考模型把**对等层次**之间传送的数据单位称为该层的协议数据单元 PDU（Protocol Data Unit）。把**层与层**之间交换的数据的单位称为服务数据单元 SDU（Service Data Unit）。

19. TCP/IP四层结构：应用层(各种应用层协议如FTP, DNS等)、运输层(TCP或UDP)、网际层(又名网络互联层 IP)、数据链路层(又名网络接口层)

<img src="https://img-blog.csdn.net/20180508085920977?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L2I5eF9f/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="img" style="zoom:50%;" />

20. 互联网现在采用**存储转发**的分组交换技术，以及三层ISP结构，主干ISP、地区ISP和本地ISP。

21. 五层协议的体系结构由应用层、运输层、网络层（或网际层）、数据链路层和物理层组成。**运输层最重要的协议是TCP和UDP协议，网络层最重要的协议是IP协议**。



## 第2章 物理层

1. 数据在计算机内部多采用并行传输方式，在通信线路上的传输方式一般都是**串行传输**。

2. 一个数据通信系统可以划分为三大部分，即**源系统（或发送端、发送方）**、**传输系统（或传输网络）**和**目的系统（或接收端、接收方）**。

3. 源系统一般包括源点（source）、发送器。目的系统一般包括接收器、终点。

4. 从通信的双方**信息交互**的方式来看，有以下三种基本方式：

   1. **单向通信（单工通信）**。即只能有一个方向的通信而没有反方向的交互。无线电广播以及电视广播属于这种类型。
   2. **双向交替通信（半双工通信）**。通信的双方都可以发送信息，但不能双方同时发送，也不能同时接收。
   3. **双向同时通信（全双工通信）**。通信的双方可以同时发送和接收信息。

   单工通信只需要一条信道，半双工通信或全双工通信需要两条信道。

5. 来自信源的信号叫做**基带信号**。调制分为两大类：**基带调制**，仅对基带信号的波形进行变换，变换后的信号仍然是基带信号，把这种过程称为**编码**；**带通调制**，使用载波进行调制，把基带信号的频率范围搬移到较高的频段，并**转换为模拟信号**。经过载波调制后的信号称为**带通信号**。

6. 常用的编码方式：**不归零制**、**归零制**、**曼彻斯特编码**、**差分曼彻斯特编码**。曼彻斯特编码产生的信号频率比不归零制高，具有自同步能力。

   <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210822152009690.png" alt="image-20210822152009690" style="zoom:50%;" />

   不归零制：

   归零制：

   曼彻斯特编码：

   差分曼彻斯特编码：

7. 基本的带通调制方法：**调幅（AM)**、**调频（FM）**、**调相（PM)**。还有更复杂的调制方法，如**正交振幅调制**。

8. 限制码元在信道上的传输速率的因素：（1）**信道能够通过的频率范围**；（2）**信噪比**（信号的平均功率和噪声的平均功率之比，记为S/N，用分贝（dB）作为度量单位）。信道的带宽或信道中的信噪比越大，信息的极限传输速率就越高。

9. 带宽受限且有高斯白噪声干扰的信道的极限、无差错的信息传输速率（香农公式）：

   信道的极限信息传输速率C可表达为：
   $$
   C=Wlog_2(1+S/N) (bit/s)
   $$
   其中，W为信道的带宽（以Hz为单位）；S为信道内所传信号的平均功率；N为信道内部的高斯噪声功率。

10. 传输媒体也称为传输介质或传输媒介，是数据传输系统中在发送器和接收器之间的物理通道。分为**导引型传输媒体**（双绞线 、同轴电缆、光缆、架空明线）和**非导引型传输媒体**（无线或红外或大气激光）。在光纤通信中常用的三个波段的中心分别位于850 nm，1300 nm和1550 nm。后两种情况的衰减都很小，850 nm波段的衰减较大，但在此波段的其他特性均较好。

11. **双绞线**，最常用的传输媒体，可以进行数字传输和模拟传输。可以分为：屏蔽双绞线 STP（Shieleded Twisted Pair）（带金属屏蔽层）、无屏蔽双绞线 UTP。对传送数据来说，现在最常用的 UTP 是**5**类线（Category 5 或 CAT5）。

12. 同轴电缆具有较好的抗干扰特性，被广泛用于传输较高速率的数据。50Ω同轴电缆——LAN/数字传输常用；75Ω同轴电缆——有线电视/模拟传输常用。

13. **光纤**是光纤通信的传输媒体。多模光纤（传输距离较近）、单模光纤。

14. 常见的信道复用技术：

    **频分复用 FDM**（Frequency Division Multiplexing），频分复用的所有用户在同样的时间占用不同的带宽资源。

    **时分复用 TDM**（Time Division Multiplexing），时分复用的所有用户在不同时间占用了同样的频带宽度。**统计时分复用 STDM**（Statistic TDM），统计复用又称为异步时分复用，按需动态的分配时隙。

    **波分复用 WDM**（Wavelength Division Multiplexing），就是光的频分复用。

    **码分复用 CDM**（Code Division Multiplexing），码分多址 CDMA。

15. 通信的目的是**传送信息**。**数据**是运送消息的实体。

16. 最初在数字传输系统中使用的传输标准是脉冲编码调制 PCM。现在高速的数字传输系统使用同步光纤网 SONET（美国标准）或同步数字系列SDH（国际标准）。

17. 用户到互联网的宽带接入方法有非对称数字用户线 ADSL、光纤同轴混合网 HFC 和 FTTx。

18. 为了有效地利用光纤资源，在光纤干线和用户之间广泛使用无源光网络 PON，最流行的无源光网络是以太网无源光网络 EPON和吉比特无源光网络 GPON。

19. 物理层的作用是要尽可能地屏蔽掉不同传输媒体和通信手段的差异。确定机械特性、电气特性、功能特性、过程特性。


## 第3章 数据链路层

1. 数据链路层使用的信道主要有以下两种类型：（1）**点对点信道**；（2）**广播信道**。

2. 从整个互联网来看，局域网属于数据链路层的范围。

3. **链路（link）**是从一个结点到相邻结点的一段物理线路（有线或无线），而中间没有任何其他的交换结点。**数据链路（data link）**把实现协议的硬件和软件加到链路上，就构成数据链路。**帧**，点对点信道的数据链路层的协议数据单元。数据链路层的三个基本问题：封装成帧、透明传输和差错检测。

4. 在互联网中，网络层协议数据单元就是IP数据报（或简称为**数据报**、**分组**或**包**）。

5. **封装成帧（framing）**就是在一段数据的前后添加首部和尾部，这样就构成了一个帧。首部和尾部的一个重要作用就是进行帧界定，此外还包括许多必要的控制信息。在发送帧时，是从帧首部开始发送的。**MTU**（Maximum Transfer Unit）：**数据部分**长度上限——最大传送单元。

   <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210824171132318.png" alt="image-20210824171132318" style="zoom:50%;" />

6. 控制字符 SOH（Start of Header）放在一帧的最前面，表示帧的首部开始，另一个控制字符 EOT（End of Transmission）表示帧的结束，它们的十六进制编码分别是01（二进制是00000001）和04（二进制是00000100）。

   <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210824171406074.png" alt="image-20210824171406074" style="zoom:50%;" />

7. **透明传输**：不管从键盘上输入什么字符都可以放在这样的帧中传输过去，这样的传输是透明传输。为了解决透明传输的问题，就必须设法使数据中可能出现的控制字符“SOH”和"EOT"在接收端不被解释为控制字符。具体方法是：发送端的数据链路层在数据中出现控制字符“SOH”和“EOF”的前面插入一个转义字符“ESC"（十六进制是1B，二进制是00011011）。在接收端的数据链路层在把数据送往网络层之前删除这个插入的转义字符。这种方法称为**字节填充**或**字符填充**。

   <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210824201209033.png" alt="image-20210824201209033" style="zoom:50%;" />

8. **比特差错**：比特在传输过程中可能产生的差错：1可能会变成0，0可能变成1。**误码率BER**：在一段时间内，传输错误的比特占所传输比特总数的比率。设法提高信噪比，可以使误码率降减小。目前在数据链路层广泛使用了**循环冗余检测CRC**（Cyclic Redundancy Check）的检错技术。帧检验序列FCS是添加在数据后面的冗余码。**传输差错**：帧丢失、帧重复和帧失序。

9. 对于点对点的链路，**点对点协议PPP**（Point-to-Point Protocol）是目前使用得**最广泛**的数据链路层协议。

10. **PPP协议**是用户计算机和ISP进行通信时所使用的数据链路层协议。在TCP/IP协议族中，可靠传输由运输层的TCP协议负责，因此数据链路层的PPP协议不需要进行纠错，不需要设置序号；不需要进行流量控制。PPP协议不支持多点线路，只支持**点对点**的链路通信，PPP协议只支持**全双工链路**。PPPoE是为宽带上网的主机使用的链路层协议。

11. PPP协议设计满足的需求：（1）简单；（2）封装成帧；（3）透明性；（4）多种网络层协议；（5）多种类型链路；（6）差错检测；（7）检测连接状态；（8）最大传送单元；（9）网络层地址协商；（10）数据压缩协商。

12. PPP协议组成：（1）一个将IP数据报封装到串行链路的方法。（2）一个用来建立、配置和测试数据链路连接的**链路控制协议LCP** (Link Control Protocol)。（3）一套**网络控制协议NCP**（Network Control Protocol），其中的每一个协议支持不同的网络层协议。

13. PPP帧的首部和尾部分别为四个字段和两个字段。

    首部的第一个字段和尾部的第二个字段都是标志字段F，规定为0x7E（二进制01111110），是PPP帧的定界符。连续两帧之间只需要用一个标志字段。首部中的地址字段A规定为0xFF（即11111111），控制字段C规定为0x03（即00000011），这两个字段实际上并没有携带PPP帧信息。首部的第四个字段是2字节的协议字段。当协议字段为0x0021时，PPP帧的信息字段就是IP数据报，若为0xC021，则信息字段是PPP链路控制协议LCP的数据，0x8021表示这是网络层的控制数据。信息字段长度不超过1500字节。尾部中的第一个字段（2字节）是使用CRC的帧检验序列FCS。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210824215058455.png" alt="image-20210824215058455" style="zoom:50%;" />

14. 当PPP使用**异步传输**时，把转义符定义为**0x7D（即01111101）**，并使用字节填充。PPP协议用在SONET/SDH链路时，使用**同步传输**，采用**零比特填充**方法实现透明传输（发送端，发现5个连续的1，立即填入一个0，接收端再把这5个连续1后的一个0删掉）。

15. PPP链路的起始和终止状态是“**链路静止**”（Link Dead）状态，这时在用户个人电脑和ISP的路由器之间并不存在物理层的连接。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210824221128957.png" alt="image-20210824221128957" style="zoom:33%;" />

16. 局域网最主要特点：网络为一个单位所拥有，且地理范围和站点数目均有限。

17. 局域网具有以下优点：（1）具有广播功能，从一个站点可很方便的访问全网。（2）便于系统的扩展和逐渐演变，各设备的位置可灵活调整和改变。（3）提高了系统的可靠性、可用性和生存性。

18. 局域网可按网络拓扑进行分类：**星形网**、**环形网**、**总线网**。总线网以**传统以太网**最为著名。**双绞线**已成为局域网中的主流传输媒体。当数据率很高时，往往需要使用**光纤**作为传输媒体。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210824223412551.png" alt="image-20210824223412551" style="zoom:33%;" />

19. 共享信道在技术上有两种方法：(1)**静态划分信道**；（2）**动态媒体接入控制**，又称为多点接入，可分为**随机接入**、**受控接入**。

20. 以太网是美国施乐公司的Palo Alto研究中心（PARC）于1975年研制成功的。DIX Ethernet V2是世界上第一个局域网产品的规约。IEEE 802委员会于1983年制定了第一个IEEE的以太网标准IEEE 802.3。

21. 适配器和局域网之间的通信是通过电缆或双绞线以**串行**传输方式进行的，而适配器和计算机之间的通信是通过计算机主板上的I/O总线以**并行**传输方式进行的。计算机的硬件地址在适配器的ROM中，计算机的软件地址——IP地址在计算机的存储器中。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210824224429906.png" alt="image-20210824224429906" style="zoom:33%;" />

22. 为了通信的简便，以太网采取以下两种措施：（1）采用较为灵活的**无连接**的工作方式，即不必先建立连接就可以直接发送数据。**以太网提供的服务是尽最大努力的交付**，即**不可靠的交付**。**在同一时间只能允许一台计算机发送数据**，使用的协议是**CSMA/CD**，即**载波监听多点接入/碰撞检测**。使用CSMA/CD协议的以太网只能进行**双向交替通信（半双工通信）**。（2）以太网发送的数据都使用**曼彻斯特编码**的信号。

23. 电磁波在1km电缆的传播时延约为5 μs。帧间最小间隔为9.6μs，相当于96比特时间。

24. 10BASE-T：“10”表示10 Mbit/s的数据率，BASE表示连接线上的信号是基带信号，T代表双绞线。10BASE-F：F代表光纤。

25. 传统的总线以太网基本上都是使用集线器的双绞线以太网，这种以太网在物理上是星形网，在逻辑上是总线形网。集线器工作在**物理层**，不进行碰撞检测，接口通过RJ-45插头。

26. 在局域网中，**硬件地址**又称为**物理地址**或者**MAC地址**。IEEE的**注册管理机构RA**是局域网全球地址的法定管理机构，负责分配地址字段的6个字节的前三个字节，这个号是**组织唯一标识符OUI**，通常也称为**公司标识符**，地址字段的后三个字节由厂家自行指派，称为**扩展标识符**。用这种方式得到的**48位**地址称为EUI-48。

27. 以太网V2的MAC帧格式：

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/XSWL0ZR_9_CZ%60PO%7D%5B11X43V.png" alt="img" style="zoom:33%;" />

28. 以太网的适配器具有过滤功能，只接收**单播帧**、**广播帧**或**多播帧**。

29. 使用集线器可以在**物理层**扩展以太网。

30. 扩展以太网更常用的方法是在**数据链路层**进行。最初使用的是**网桥**，后来使用的是**以太网交换机**。以太网交换机本质就是一个**多接口的网桥**，相互通信的主机都是**独占传输媒体，无碰撞地传输数据**。其内部的**交换表**是通过**自学习**算法自动逐渐建立起来的。

31. 10吉比特以太网（10GE）只工作在**全双工方式**，不存在争用问题，不适用CSMA/CD协议。

## 第4章 网络层

1. **网络层向上只提供简单灵活的、无连接的、尽最大努力交付的数据报（datagram）服务**。网络在发送分组时不需要先建立连接。**网络层不提供服务质量的承诺**。进程之间的可靠性由网络的主机中的**运输层**负责。

2. 在整个互联网上的交付有两种：在本网络上的直接交付和到其他网络的间接交付（经过至少一个路由器，但最后一次一定是直接交付）。

3. 虚电路服务与数据报服务的对比：

   <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210825145640110.png" alt="image-20210825145640110" style="zoom:33%;" />

4. 网际协议IP又称为Kahn-Cerf协议，是TCP/IP体系中两个最主要的协议之一。与IP协议配套使用的还有三个协议：（1）**地址解析协议ARP**（Address Resolution Protocol）；（2）**网际控制报文协议ICMP**（Internet Control Message Protocol）；（3）**网际组管理协议IGMP**（Internet Group Management Protocol）。

   <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210825150146806.png" alt="image-20210825150146806" style="zoom:33%;" />

5. 将网络互相连接起来要使用的一些**中间设备**：

   - 物理层使用的中间设备叫做**转发器**（repeater）。
   - 数据链路层使用的中间设备叫做**网桥**或**桥接器**（bridge）。
   - 网络层使用的中间设备叫做**路由器**（router）。
   - 在网络层以上使用的中间设备叫做**网关**（gateway）。用网关连接两个不兼容的系统需要在高层进行协议的转换。

6. **虚拟互联网络（internet）**就是逻辑互联网络，意思是互连起来的各种物理网络的异构性本来是客观存在的，但是利用IP协议就可以使这些性能各异的网络**在网络层上看起来好像是一个统一的网络**。这种使用IP协议的虚拟互联网络可简称为**IP网**。

7. **互联网可以由多种异构网络互连组成**。整个的互联网是一个**单一的、抽象的网络**。IP地址是一个**32位**的标识符。IP地址是32位的**二进制**代码，为了书写方便，可用等效的十进制数字表示，并在这些数字之间加上一个点，叫做**点分十进制记法**。IP地址现在由**互联网名字和数字分配机构ICANN**进行分配。

8. IP地址的编址方法经过了三个历史阶段：（1）分类的IP地址；（2）子网的划分；（3）构成超网。

9. **分类的IP地址**就是将IP地址划分为若干个固定类，每一类地址都由另个固定长度的字段组成，其中第一个字段是**网络号**（net-id），它标志主机（或路由器）所连接到的网络。第二个字段是**主机号**（host-id），它标志该主机（或路由器）。一个IP地址**在整个互联网范围内是唯一的**。这种两级的IP地址可以记为：

   <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210825162411342.png" alt="image-20210825162411342" style="zoom:33%;" />

   <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210825162431364.png" alt="image-20210825162431364" style="zoom:33%;" />

   其中A,B,C类地址都是**单播地址**（一对一通信），是最常用的。A类、B类和C类地址的网络号字段的最前面有1-3位的**类别位**，其数值分别规定为0,10和110。A类、B类和C类地址的主机号段分别为3个、2个和1个字节长D类地址用于**多播**（一对多通信）。

10. A类地址中，IP地址中的全0为“本网络”，网络号为127保留为**环回测试**本主机的进程之间的通信之用（如127.0.0.1）。A类网络的最大主机数是2^(24)-2，减2的原因是：全0的主机号段表示该IP地址是“本主机”所连接到的**单个网络地址**（如，一主机的IP地址为5.6.7.8，则该主机所在的网络地址就是5.0.0.0），全1的主机号段表示该网络上的所有主机。A类地址占了整个IP地址的50%。B类地址占整个IP地址的25%。IP地址的指派范围：

   <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210825165444981.png" alt="image-20210825165444981" style="zoom:33%;" />

11. IP地址是一种**分等级**的地址结构，实际上IP地址是标志一台主机（或路由器）和一条链路的**接口**。一个网络是指具有相同网络号net-id的主机的集合，**用转发器或网桥连接起来的若干个局域网仍为一个网络**。在IP地址中，所有分配到的网络号的网络都是**平等**的。一个路由器至少应当有两个不同的IP地址。

12. **物理地址是数据链路层和物理层使用的地址，IP地址是网络层和以上各层使用的地址，是一种逻辑地址**（称IP地址为逻辑地址是因为IP地址是用软件实现的）。IP地址是放在IP数据报的首部，而硬件地址放在MAC帧的首部。**在网络层及以上使用IP地址，在数据链路层及以下使用的是硬件地址**。在IP层抽象的互联网上只能看到IP数据报，路由器只根据目的站的IP地址的网络号进行路由选择。在局域网的链路层，只能看见MAC帧。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210825171254631.png" alt="image-20210825171254631" style="zoom:33%;" />

13. **地址解析协议ARP**用于从网络层使用的IP地址，解析出在数据链路层使用的硬件地址。ARP是解决**同一个局域网上**的主机或路由器的IP地址和硬件地址的映射问题。ARP的高速缓存可以大大减小网络上的通信量。

14. 一个IP数据报由首部和数据两部分组。首部前一部分是**固定长度**，共20字节，是所以IP数据报所必须的。IP数据报的完整格式：

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210825204133097.png" alt="image-20210825204133097" style="zoom:33%;" />

    （1）版本：占4位，指IP协议的版本。

    （2）首部地址：占4位，可表示的最大十进制数值是15。首部长度字段表示数的单位是32位字（1个32位字长是4字节）。因为IP首部的固定长度是20字节，所以首部长度字段的最小值是5（二进制0101）。**IP数据报的数据部分永远在4字节的整数倍时开始**。最常用的首部长度是20字节（即首部长度为0101）。

    （3）区分服务：占8位。一般不用这个字段。

    （4）总长度，指的是首部和数据之和的长度，单位为字节。总长度字段为16位，数据报的最大长度为2^16^-1=65535字节。IP协议规定，在互联网中所有的主机和路由器，必须能够接受长度不超过576字节的数据报（假定上层交下来的数据长度有 512字节，再加上IP首部60字节，再加上4字节的富余量）。

    （5）标识（identification）：占16位。由于数据报因为长度超过网络的MTU而必须分片时，这个标识字段的值就被复制到所有的数据报片的标识字段中。相同的标识字段的值使分片后的各数据报最后能正确地重装成为原来的数据报。

    （6）标志（flag）：占3位。但目前只有两位有意义。最低位记为**MF**，MF=1意味着后面还有分片，MF=0标识这是若干数据报片中的最后一个。中间一位记为**DF**，意思是“**不能分片**”，当DF=0才允许分片。

    （7）片偏移：占13位。指出较长的分组在分片后，某片在原分组中的相对位置。片偏移以8个字节为偏移单位，每个分片的长度一定是8字节（64位）的整数倍。

    （8）生存时间：占8位。TTL（Time To Live），表明数据报在网络中的寿命。现在的TTL的单位是**跳数**。指明数据报在互联网中至多可经过多少个路由器（最大值为255）。

    （9）协议：占8位。

    （10）首部检验和：占16位。只检验数据报的首部，不包括数据部分。

    （11）源地址：占32位

    （12）目的地址：占32位

15. 在互联网上转发分组时，是**从一个路由器转发到下一个路由器**。在路由表中，对每一条路由最主要的是以下两个信息：**（目的网络地址，下一跳地址）**。互联网的分组转发都是**基于目的主机所在得网络**。

16. 划分子网（subnetting）的方法是从网络的主机号借用若干位作为子网号（subnet-id），于是两级IP地址在**本单位内部**就变成为**三级IP地址：网络号、子网号和主机号**。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210825224759078.png" alt="image-20210825224759078" style="zoom:33%;" />

17. 子网掩码（subnet mask）：不管网络有没有划分子网，只要把子网掩码和IP地址进行逐位的**“与”**运算，就可以得出网络地址来。**A类地址的默认子网掩码是255.0.0.0，或0xFF000000；B类地址的默认子网掩码是255.255.0.0，或0xFFFF0000；C类地址的默认子网掩码是255.255.255.0，或0xFFFFFF00。**子网掩码是一个网络或一个子网的重要属性。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210825230449310.png" alt="image-20210825230449310" style="zoom:33%;" />

18. 划分子网增加了灵活性，但却减少了能够连接在网络上的主机总数。

19. **无分类域间路由选择CIDR（Classless Inter-Domain Routing）**，无分类编址，CIDR消除了传统的A类、B类和C类地址以及划分子网的概念，把网络前缀都相同的连续的IP地址组成一个“CIDR地址块”。CIDR使用“**斜线记法**”，或称为**CIDR记法**，即在IP地址后面加上斜线“/”，然后写上网络前缀所占的位数。斜线记法中，**斜线后面的数字就是地址掩码中1的个数**。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210825232441375.png" alt="image-20210825232441375" style="zoom:33%;" />

20. **路由聚合（route aggregation）**也称为**构成超网（superneting）**，是将网络前缀**缩短**。**网络前缀越短，其地址块所包含的地址数就越多**。

21. **最长前缀匹配**（longest-prefix matching）：从匹配结果中选择具有最长网络前缀的路由。最长前缀匹配又称为**最长匹配**或**最佳匹配**。使用**二叉线索**查找路由表。

22. **网际控制报文协议ICMP**（Internet Control Message Prtocol），是**IP层**的协议。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210825234839423.png" alt="image-20210825234839423" style="zoom:33%;" />

23. ICMP报文的种类有两种，即**ICMP差错报文**和**ICMP询问报文**。ICMP报文的前4个字节是统一的格式，共有三个字段：类型、代码和检验和。接着的4个字节的内容与ICMP的类型有关。最后面是数据字段，其长度取决于ICMP的类型。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210826094945274.png" alt="image-20210826094945274" style="zoom:33%;" />

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210826095124113.png" alt="image-20210826095124113" style="zoom:33%;" />

24. 不应发送ICMP差错报告报文的几种情况：

    - **对ICMP差错报告报文**，不再发送ICMP差错报告报文。
    - **对第一个分片的数据报片的所有后续数据报片**，都不发送ICMP差错报告报文。
    - **对具有多播地址的数据报**，都不发送ICMP差错报告报文。
    - **对具有特殊地址（如172.0.0.0或0.0.0.0）的数据报**，不发送ICMP差错报告报文。

25. 常见的ICMP询问报文有两种：（1）**回送请求和回答**（用于测试目的站是否可达以及了解其有关状态）；（2）**时间戳请求和回答**（用于时钟同步和时间测量）。

26. ICMP的一个重要应用就是**分组网间探测PING**（Packet InterNet Groper），用来测试两台主机之间的连通性。**PING**是应用层直接使用网络层ICMP的一个例子，没有通过运输层的TCP或UDP。PING应用了ICMP回送请求与回送回答报文。使用**tracert**命令获取目的主机的路由信息。

27. 一个理想的路由算法应具有以下的特点：

    - 算法必须是正确的和完整的。
    - 算法在计算上应简单。
    - 算法应能适应通信量和网络拓扑的变化，要有自适应性。
    - 算法应具有稳定性
    - 算法应是公平的
    - 算法应是最佳的

28. 从路由算法能否随网络的通信量或拓扑自适应地进行调整变化来划分，分为**静态路由选择策略**（**非自适应路由选择**）与**动态路由选择策略**（**自适应路由选择**）。动态路由选择适用于较复杂的大网络。互联网采用的路由选择协议主要是**自适应的（即动态的）、分布式路由选择协议**。

29. 自治系统（autonomous system），记为AS，是在单一技术管理下的一组路由器，这些路由器使用一种自治系统内部的路由选择协议和共同的度量。一个AS对其他AS表现出的是**一个单一的和一致的路由选择策略**。

30. 互联网把路由选择协议划分为两大类：（1）**内部网关协议IGP**（Interior Gateway Protocol）。目前这类路由选择协议使用得最多，如RIP和OSPF协议。（2）**外部网关协议EGP**（Exteral Gateway Protocol）。目前使用最多的外部网关协议是BGP的版本4（**BGP-4**)。BGP，边界网关协议。

31. 自治系统之间的路由选择也叫**域间路由选择**（interdomain routing），在自治系统内部的路由选择也叫**域内路由选择**（intradomain routing）。

32. RIP（Routing Information Protocol）是内部网关协议IGP中最先得到广泛使用的协议，中文名称叫路由信息协议。RIP是一种分布式的**基于距离向量的路由选择协议**，最大优点是简单。RIP协议的“距离”也称为“跳数”（hop count）。RIP认为好的路由就是它通过的路由器的数目少，即“距离短”。RIP允许一条路径最多只能包含**15**个路由器（16表示意味着不可到达）。**RIP只适用于小型互联网**。RIP选择一条具有最少路由器的路由（最短路由），哪怕还存在另一条高速但路由器较多的路由。

33. RIP协议的特点：（1）**仅与相邻路由器交换信息**。（2）路由器交换的信息是**当前本路由器所知道的全部信息，即自己现在的路由表**。“到所有网络的距离和下一跳路由器”。（3）按**固定的时间间隔**交换路由信息。

34. 路由表中最主要的信息就是：到某个网络的距离（最短距离），以及应经过的下一跳地址。路由表更新的原则是找出到每个目的网络的**最短距离**。这种更新算法又称为**距离向量算法**。

35. RIP存在的一个问题是**当网络出现故障时，要经过比较长的时间才能将此信息传送到所有的路由器**。这个特点是：**好消息传播得快，而坏消息传播得慢**。RIP协议最大的优点是**实现简单，开销较小**。

36. **开放最短路径优先OSPF**（Open Shortest Path First），使用了**Dijkstra提出的最短路径算法SPF**。OSPF只是一个协议的名字，**它并不表示其他的路由选择协议不是“最短路径优先”**。

37. OSPF最主要的特征是使用分布式的**链路状态协议**（link state protocol）。OSPF使用**洪泛法**（flooding）向本自治系统中**所有路由器**发送信息。发送的信息就是与本路由器**相邻的所有路由器的链路状态**。**只有当链路状态发生变化时**，路由器才向所有路由器用洪泛法发送此信息。OSPF使用的是**可靠的洪泛法**，在收到更新分组后要发送确认。

38. OSPF**直接用IP数据报传送**（其IP数据报首部的协议字段值为89）。OSPF允许管理员给每条路由指派不同的代价，**OSPF对于不同类型的业务可计算出不同的路由**。如果到同一目的网络有多条相同代价的路径，可以将通信量分配给这几条路径，这叫做多路径间的**负载平衡**（load balancig）。所有在OSPF路由器之间交换的分组都居于**鉴别**的功能。OSPF支持可变长度的子网划分和无分类的编址CIDR。

39. OSPF共有以下五种分组类型：（1）**类型1，问候(hello)分组**，用来发现和维持邻站的可达性。每两个相邻的路由器每隔10秒交换一次问候分组。（2）**类型2，数据库描述**（Database Description）分组，向邻站给出自己的链路状态数据库中的所有链路状态项目的摘要信息。（3）**类型3，链路状态请求**（Link State Request）分组，向对方请求发送某些链路状态项目的详细信息。（4）**类型4，链路状态更新**（Link State Update）分组，用洪泛法对全网更新链路状态。这种分组是最复杂的，也是OSPF协议中最核心的部分。（5）**类型5，链路状态确认**（Link State Acknowledgment）分组，对链路更新分组的确认。

40. 边界网关协议BGP采用**路径向量（path vector）路由选择协议**，RIP是一种分布式的**基于距离向量的路由选择协议**，OSPF使用分布式的**链路状态协议**。BGP是力求寻找一条能够到达目的网络且**比较好**的路由，而**并非要寻找一条最佳路由**。BGP-4是不同AS的路由器之间交换路由信息的协议。

41. BGP协议交换路由信息的结点数量级是**自治系统个数**的数量级。

42. 路由器是一种具有多个输入端口和多个输出端口的专用计算机，其任务是转发分组。从路由器某个输入端口收到的分组，按照分组要去的目的地（即目的网络），把该分组从路由器的某个合适的输出端口转发给下一跳路由器。**路由器的转发分组是网络层的主要工作**。整个路由器结构可划分为两大部分：**路由选择**部分和**分组转发**部分。

43. 路由选择部分也叫做**控制部分**，核心构件是路由选择处理机。分组转发部分由三部分组成：**交换部分**、一组**输入端口**和一组**输出端口**。交换结构（switching fabric）又称为**交换组织**，作用就是根据**转发表**对分组进行处理，将某个输入端口进入的分组从一个合适的输出端口转发出去。常用的交换方法：（1）通过存储器；（2）通过总线；（3）通过互联网络。

44. IPv6支持无连接的传送，但将协议数据单元PDU称为**分组**，而不是IPv4的数据报。为方便起见，仍采用数据报这一名词。IPv6的改进：（1）**更大的地址空间**。IPv6的地址从IPv4的32位增大到**128位**。（2）**扩展的地址层次结构**。（3）**灵活的首部格式**。IPv6数据报的首部与IPv4的并不兼容。IPv6的首部长度是固定的。(**40字节**）（4）**改进的选项**。IPv6允许数据报包含有选项的控制信息。（5）**允许协议继续扩充**。（6）**支持即插即用（即自动配置）**。IPv6不需要使用DHCP。（7）**支持资源的预分配**。（8）IPv6首部改为**8字节对齐**。IPv4的首部是4字节对齐。

45. IPv6数据报由两大部分组成，即**基本首部**（base header）和**有效载荷**（payload）。有效载荷也称为**净载荷**。有效载荷允许有零个或多个**扩展首部**（extension header），再后面是数据部分。所有的扩展首部并不属于IPv6数据报的首部。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210826220606469.png" alt="image-20210826220606469" style="zoom:33%;" />

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210826220924458.png" alt="image-20210826220924458" style="zoom:33%;" />

46. IPv6数据报的目的地址可以是以下三种基本类型地址之一：（1）**单播**，就是传统的点对点通信。（2）**多播**，就是一点对多点通信。（3）**任播**（anycast），任播的终点是一组计算机，但数据报只交付其中的一个，通常是距离最近的一个。

47. IPv6把实现IPv6的主机和路由器均称为**结点**。IPv6使用**冒号十六进制记法**（colon hexadecimal notation，简写为colon hex），它把每个**16位**的值使用十六进制值表示，各值之间用冒号分隔。冒号十六进制记法可以允许**零压缩**（zero compression），即一连串连续的零可以为一对冒号所替代，规定在任意地址中只能使用一次零压缩。CIDR的斜线表示法仍然可用，但是不能把16位地址块中最后的0省略。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210826223404575.png" alt="image-20210826223404575" style="zoom:33%;" />

48. **未指明地址**：16字节的全0地址，这类地址只有一个。**换回地址**：::1，只有一个。**多播地址**：占1/256.**本地链路单播地址**（Link-Local Unicast Address）：不能和互联网上的其他主机通信，占总数的1/1024。**全球单播地址**：IPv6的这一类单播地址是使用得最多的一类。 

49. 两种向IPv6过度的策略：**双协议栈**（dual stack）、**隧道技术**（tunneling）。

50. IPv6也需要使用ICMP来反馈一些信息。ICMPv6是面向**报文**的协议，利用报文来报告差错，获取信息，探测邻站或管理多播通信。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210826232307818.png" alt="image-20210826232307818" style="zoom:33%;" />

51. 多播主干网MBONE（Multicast Backbone On the Internet）。多播组的标识符就是IP地址中的**D类地址**。D类IP地址的前四位是1110，因此D类地址的范围是224.0.0.0到239.255.255.255。**多播地址只能用于目的地址，不能用于源地址**。对多播数据报不产生ICMP差错报文。

52. IP多播可以分两种，一种是只在本局域网上进行硬件多播，另一种则是在互联网的范围进行多播。IANA拥有的以太网多播地址的范围是从01-00-5E-00-00-00到01-00-5E-7F-FF-FF。

53. IP多播需要两种协议：（1）**网际组管理协议IGMP**（Internet Group Management Protocol），让连接在本地局域网上的多播路由器知道本局域网上是否有主机参加或退出了某个多播组。（2）**多播路由选择协议**，用来在多播路由器之间传播路由信息。它们在转发多播数据报时使用了以下的三种方法：a.**洪泛与剪除**。b.**隧道技术**。c.**基于核心的发现技术**。建议使用的多播路由选择协议：**距离向量多播路由选择协议DVMRP**、**基于核心的转发树CBT**、**开放最短通路优先的多播扩展MOSPF**、**协议无关多播-稀疏方式PIM-SM**、**协议无关多播-密集方式PIM-DM**。

54. 多播数据报可以由没有加入多播组的主机发出，也可以通过没有组成员接入的网络。

55. **在互联网中的所有路由器，对目的地址是专用地址的数据报一律不进行转发。**专用地址（private address）：

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210827002045959.png" alt="image-20210827002045959" style="zoom:33%;" />

56. 虚拟专用网VPN（Virtual Private Network）利用公用的互联网作为本机构各专用网之间的通信载体。VPN内部使用互联网的专用地址。

57. 网络地址转换NAT（Network Address Translation）可以在专用网络内部使用专用IP地址，仅在连接到互联网的路由器使用全球IP地址。

58. 多协议标记交换MPLS（MultiProtocol Label Switching）在入口结点给每一个IP数据报打上固定长度的“标记”，然后根据标记在第二层（数据链路层）用硬件进行转发（在标记交换路由器中进行标记对换），因而转发速率大大加快。

## 第5章 运输层

1. 运输层提供应用进程间的逻辑通信。**运输层向它上面的应用层提供通信服务**。

2. **网络层为主机之间提供逻辑通信，而运输层为应用进程之间提供端到端的逻辑通信**。只有主机的协议栈才有运输层，而网络核心部门中的路由器在转发分组时都只用到下三层的功能。**通信的真正端点并不是主机而是主机中的进程**。

   <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210828101209715.png" alt="image-20210828101209715" style="zoom:33%;" />

3. 运输层有两个主要的协议：**TCP和UDP**。它们都有**复用**和**分用**，以及**检错**的功能。当运输层**采用面向连接的TCP协议时，尽管下面的网络时不可靠的**（只提供尽最大努力服务），但这种逻辑通信信道就相当于一条**全双工通信的可靠信道**。当运输层采用无连接的UDP协议时，这种逻辑通信信道仍然是一条**不可靠信道**。

4. **用户数据报协议UDP**（User Datagram Protocol），**传输控制协议TCP**（Transmission Control Protocol）。按照OSI的术语，两个对等运输实体在通信时传送的数据单位叫做**运输协议数据单元**TPDU（Transport Protocol Data Unit）。但在TCP/IP体系中，则根据所使用的的协议是TCP或UDP，分别称为**TCP报文段**（segment）或**UDP用户数据报**。

   <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210828105922524.png" alt="image-20210828105922524" style="zoom:33%;" />

5. **在协议栈层间的抽象的协议端口是软件端口**，硬件端口是**不同硬件设备**进行交互的接口，而**软件端口是应用层的各种协议进程与运输实体进行层间交互的一种地址**。运输层用一个16位**端口号**来标志一个端口。**端口号只具有本地意义**，它只是为了标志本计算机应用层中的各个进程在和运输层交互时的层间接口。在互联网的不同计算机中，相同的端口号是没有关联的。

6. 两台计算机中的进程要互相通信，不仅要知道对方的IP地址（为了找到对方的计算机），而且还要知道对方的端口号（为了找到对方计算机中的应用进程）。

7. 运输层的端口号分为**服务器端使用的端口号**（0-1023指派给**熟知端口**或**系统端口**，1024-49151是**登记端口**）和**客户端暂时使用的端口号**（49152-65535）。

   <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210828111514686.png" alt="image-20210828111514686" style="zoom:33%;" />

8. UDP的主要特点：（1）**无连接**；（2）尽最大努力交付；（3）面向**报文**；UDP一次交付一个完整的报文。（4）无拥塞控制；（5）支持一对一、一对多、多对一和多对多的交互通信；（6）首部开销小（只有四个字段：**源端口**、**目的端口**、**长度**、**检验和**，每个字段的长度都是两个字节）。UDP的检验和是**把首部和数据部分一起都检验**。

   <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210828111608758.png" alt="image-20210828111608758" style="zoom:33%;" />

9. TCP的主要特点：（1）**面向连接**；（2）**每一条TCP连接只能是点对点的（一对一）**；（3）提供可靠交付的服务；（4）提供**全双工通信**；（5）面向**字节流**。”流“（stream）指的是流入到进程或从进程流出的字节序列。

10. **最大报文段长度**MSS（Maxumin Segment Size），是**每一个**TCP报文段中的**数据字段的最大长度**。MSS的默认值是536字节长，所有在互联网上的主机都应能接受的报文段长度是536+20（固定首部长度）=556字节。

11. TCP报文段先要传送到IP层，加上IP首部后，再传送到数据链路层。再加上数据链路层的首部和尾部后，才离开主机发送到物理链路。

12. TCP把**连接**作为**最基本的抽象**。TCP用主机的IP地址加上主机上的端口号作为TCP连接的端点。这样的端点叫做**套接字（socket）或插口**。套接字用（**IP地址：端口号**）来表示。**每一条TCP连接唯一地被通信两端的两个端点（即两个套接字）所确定**。TCP连接的端点是个很抽象的套接字。

13. **停止等待协议**能够在不可靠的传输网络上实现可靠的通信。每发送完一个分组就停止发送，等待对方的确认。在收到确认后再发送下一个分组。分组需要进行编号。

14. **超时重传**是指只要超过了一段时间仍然没有收到确认，就重传前面发送过的分组（认为刚才发送的分组丢失了）。因此每发送完一个分组需要设置一个超时计时器，其重传时间应比数据在分组传输的平均往返时间更长一些。这种自动重传方式常称为**自动重传请求ARQ**。

15. 在停止等待协议中，若接收方收到重复分组，就丢弃该分组，但同时还要发送确认。

16. **连续ARQ协议**可提高信道利用率。发送方维持一个发送窗口，凡位于发送窗口内的分组都可连续发送出去，而不需要等待对方的确认。接收方一般采用**累积确认**，**对按序到达的最后一个分组发送确认**，表明到这个分组为止的所有分组都已正确收到了。

17. TCP报文段首部的**前20个字节**是固定的，后面有4N字节是根据需要而增加的选项（N是整数）。在一个TCP连接中传送的字节流中的每一个字节都按顺序编号。首部中的序号字段值则指的是本报文段所发送的数据的第一个字节的序号。

18. TCP首部中的确认号是期望收到对方下一个报文段的第一个数据字节的序号，若确认号为N，则表明：到序号N-1为止的所有数据都已正确收到。

19. TCP首部中的窗口字段指出了现在允许对方发送的数据量。窗口值是经常在动态变化着的。

20. TCP使用**滑动窗口机制**。发送窗口里面的序号表示允许发送的序号。发送窗口后沿的后面部分表示已发送且已收到了确认，而发送窗口前沿的前面部分表示不允许发送。发送窗口后沿的变化情况有两种可能，即不动（没有收到新的确认）和前移（收到了新的确认）。发送窗口前沿通常是不断向前移动的。TCP的窗口单位是**字节**，不是报文段。

21. **流量控制**就是让**发送方**的发送速率不要太快，要让接收方来得及接收。

22. 在某段时间，若对网络中的某一资源的需求超过了该资源所能提供的可用部分，网络的性能就要变坏。这种情况就叫做**拥塞**。**拥塞控制**就是防止过多的数据注入到网络中，这样可以使网络中的路由器或链路不致过载。

23. 流量控制是一个**端到端**的问题，是接收端抑制发送端发送数据的速率，以便使接收端来得及接收。拥塞控制是一个**全局性**的过程，涉及到所有的主机、所有的路由器，以及与降低网络传输性能有关的所有因素。

24. 为了进行拥塞控制，TCP的发送方要维持一个拥塞窗口cwnd的状态变量。拥塞窗口的大小取决于网络的拥塞程度，并且动态的在变化。发送方让自己的发送窗口取为拥塞窗口和接收方的接收窗口中较小的一个。

25. TCP的**拥塞控制**采用了四种算法，即**慢开始**、**拥塞避免**、**快重传**和**快恢复**。在网络层，也可以使路由器采用适当的分组丢弃策略（如主动队列管理AQM），以减少网络拥塞的发生。

26. **基于窗口**的拥塞控制：**发送方让自己的发送窗口等于拥塞窗口**。判断网络拥塞的依据就是出现了超时。

27. **慢开始**：由小到大逐渐增大拥塞窗口的数值。快重传算法规定，发送方只要**一连收到3个重复确认**，就应当**立即进行重传**（即“快重传”）。

28. 运输连接有三个阶段，即：**连接建立**、**数据传送**和**连接释放**。

29. TCP建立连接的过程叫做**握手**，握手需要在客户和服务器之间交换三个TCP报文段。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210828171449765.png" alt="image-20210828171449765" style="zoom:33%;" />

    在本例子中，A主动打开连接，B被动打开连接。

    一开始，B的TCP服务器进程先创建传输控制块TCB，准备接受用户进程的连接请求。然后服务器进程就处于LISTEN（收听）状态，等待客户的连接请求。如有，即作出响应。

    A的TCP客户进程也是首先创建传输控制模块TCB。然后，在打算建立TCP连接时，向B发出连接请求报文段，这时首部中的同步位SYN=1，同时是选择一个初始序号seq=x。TCP规定，SYN报文段（即SYN=1的报文段）不能携带数据，但要消耗掉一个序号。这时，TCP客户进程进入SYN-SENT（同步已发送）状态。

    B收到连接请求报文段后，如同意建立连接，则向A发送确认。在确认报文段中应把SYN位和ACK位都置1，确认号是ack=x+1，同时也为自己选择一个初始序号seq=y。这时TCP服务器进程进入SYN-RCVD（同步收到）状态。

    TCP客户进程收到B的确认后，还要向B给出确认。确认报文段的ACK置1，确认号ack=y+1，而自己的序号seq=x+1。TCP的标准规定，ACK报文段可以携带数据。但**如果不携带数据则不消耗序号**，在这种情况下，下一个数据报文段的序号仍是seq=x+1。这时，TCP连接已经建立，A进入ESTABLISHED（已建立连接）状态。

    当B收到A的确认后，也进入ESTABLISHED状态。

30. 主动发起TCP连接建立的应用进程叫做**客户**，而被动等待连接建立的应用进程叫做**服务器**。**TCP的连接建立采用三报文握手机制**。服务器要确认客户的连接请求，然后客户要对服务器的确认进行确认。

31. **TCP的连接释放采用四报文握手机制**。任何一方都可以在数据传送结束后发出连接释放的通知，待对方确认后就进入**半关闭**状态。当另一方也没有数据再发送时，则发送连接释放通知，对方确认后就**完全关闭**了TCP连接。

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210828211019688.png" alt="image-20210828211019688" style="zoom:33%;" />

    数据传输结束后，通信的双方都可释放连接。现在A和B都处于ESTABLISHED状态。A的应用进程先向其TCP发出连接释放报文段，并停止再发送数据，主动关闭TCP连接。A把连接释放报文段首部的终止控制位FIN位置置1，其序号seq=u，他等于前面已传送过的数据的最后一个字节的序号加1.这时A进入FIN-WAIT-1（终止等待1）状态，等待B的确认。

    B收到连接释放报文段后即发出确认，确认后是ack=u+1，而这个报文段自己的序号是v，等于B前面已传送过的数据的最后一个字节的序号加1.然后B就进入CLOSED-WAIT（关闭等待）状态。TCP服务器进程这时应通知高层应用进程，因而从A到B这个方向的连接就释放了，这时的TCP连接处于**半关闭**（half-close）状态，即A已经没有数据要发送了，但B若发送数据，A仍要接收。

    A收到来自B的确认后，就进入FIN-WAIT-2（终止等待2）状态，等待B发出的连接释放报文段。

    若B已经没有要向A发送的数据，其应用进程就通知TCP释放连接。这是B发出的连接释放报文段必须使FIN=1。现假定B的序号为w（在半关闭状态B可能又发送了一些数据）。B还必须重复上次已发送过的确认号ack=u+1。这是B就进入LAST-ACK（最后确认）状态，等待A的确认。

    A在收到B的连接释放报文段后，必须对此发出确认。在确认报文段中把ACK置1，确认号ack=w+1，而自己的序号是seq=u+1。然后进入TIME-WAIT（时间等待）状态。必须经过**时间等待计时器**设置的时间2MSL后，A才进入到CLOSED状态。时间MSL叫做**最长报文段寿命**。

32. TCP有限状态机

    <img src="picture/1.%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20210828215115902.png" alt="image-20210828215115902" style="zoom:50%;" />

## 第6章 应用层

1. 应用层协议是为了解决某一类应用问题，而问题的解决又是通过位于不同主机中的多个应用进程之间的通信和协同工作来完成的。应用层规定了应用进程在通信时所遵循的协议。应用层的很多协议都是基于**客户服务器**方式的。**客户是服务请求方，服务器是服务提供方**。客户和服务器都是指通信中所涉及的两个应用程序。
2. 域名系统DNS是互联网使用的命名系统，用来把便于人们使用的机器名字转换为IP地址。DNS是一个联机分布式数据库系统，并采用客户服务器方式。**DNS——从域名解析出IP地址**。
3. 域名到IP地址的解析是由分布在互联网上的许多**域名服务器程序（即域名服务器）**共同完成的。
4. 互联网采用**层次树状结构**的命名方法，任何一台连接在互联网上的主机或路由器，都有一个唯一的层次结构的名字，即域名。
5. 域名服务器分为**根域名服务器**、**顶级域名服务器**、**权限域名服务器**和**本地域名服务器**。
6. 主机向本地域名服务器的查询一般都是采用**递归查询**。本地域名服务区向根服务器的查询通常是采用**迭代查询**。
7. **文件传送协议FTP**使用**TCP**可靠的运输服务。FTP使用**客户服务器**方式。一个FTP服务器进程可同时为多个客户进程提供服务。在进行文件传输时，FTP的客户和服务器之间要建立两个并行的TCP连接：**控制连接**和**数据连接**。实际用于传输文件的是**数据连接**。
8. FTP客户进程端口**21**，服务器进程端口**20**。FTP使用了两个不同的端口号。
9. 网络文件系统NFS，**允许应用进程打开一个远地文件，并能在该文件的某一个特定的位置上开始读写数据**。在网络上传送的只是少量的修改数据。
10. **简单文件传送协议TFTP**，使用UDP数据报。
11. **万维网WWW是一个大规模的、联机式的信息储藏所**，可以非常方便地从互联网上的一个站点链接到另一个站点。万维网是一个分布式的**超媒体**系统，是**超文本**系统的扩充。
12. 万维网的客户程序向互联网中的服务器程序发出请求，服务器程序向客户程序送回客户所需的万维网文档。在客户程序主窗口上显示出的万维网文档称为**页面**。
13. 万维网使用**统一资源定位符URL**来标志万维网上的各种文档，并使每一个文档在整个互联网的范围内具有唯一的标识符URL。
14. 万维网客户程序与服务器程序之间进行交互所使用的协议是**超文本传送协议HTTP**。HTTP使用**TCP**连接进行可靠的传送。但HTTP协议本身是**无连接**、**无状态**的。HTTP/1.1协议使用了**持续连接**（分为非流水线方式和流水线方式）。HTTP的默认端口号是**80**。HTTP是**面向事务的**应用层协议。HTTP是**面向文本的**。
15. 万维网使用超文本标记语言**HTML**来显示各种万维网页面。**HTML不是应用层协议**，是万维网浏览器使用的一种语言。
16. **XML**是**可扩展标记语言**，其设计宗旨是传输数据。
17. **静态文档**在文档创作完毕后就存放在万维网服务器中，在被用户浏览的过程中，**内容不会改变**。**动态文档**是指文档的内容是在浏览器访问万维网服务器时才由应用程序动态创建的。
18. 在万维网中用来进行搜索的工具叫做**搜索引擎**。搜索引擎大体上可划分为**全文检索搜索引擎**和**分类目录搜索引擎**两大类。
19. 一个电子邮件系统有三个主要组成构件，即：**用户代理**、**邮件服务器**，以及**邮件协议**（包括邮件发送协议，如SMTP，和邮件读取协议，如POP3和IMAP).
20. **简单邮件传送协议SMTP**、**POP3**邮局协议的版本3。用户代理UA是用户与电子邮件系统的接口，在大多数情况下就是运行在用户电脑中的一个程序，又称为**电子邮件客户端软件**。
21. **SMTP不使用中间的邮件服务器**。发送邮件的协议：**SMTP**。常用的邮件读取协议有两个，即**邮局协议第3个版本POP3**和**网际报文存取协议IMAP**（Internet Message Access Protocol）。
22. 用户浏览器和邮件服务器之间的邮件传送使用**HTTP**协议，而在邮件服务器之间邮件的传送仍然使用**SMTP**协议。
23. **动态主机配置协议DHCP**，提供了一种机制，称为**即插即用连网**。
24. **简单网络管理协议SNMP**由三部分组成，即（1）**SNMP**本身，负责读取和改变各代理中的对象名及其状态数值；（2）**管理信息结构**SMI，定义命名对象和定义对象类型（包括范围和长度）的通用规则，以及把对象和对象的值进行编码的基本编码规则BER；（3）**管理信息库MIB**，在被管理的实体中创建了命名对象，并规定了其类型。
25. **系统调用接口**是应用进程的控制权和操作系统的控制权进行转换的一个接口，又称为**应用编码接口API**。API就是应用程序和操作系统之间的接口。
26. **套接字**是应用进程和运输层协议之间的接口，是应用进程为了获得网络通信服务而与操作系统进行交互时使用的一种机制。
27. 目前**P2P**工作方式下的**文件共享**在互联网流量中已占据最大的份额。
28. **BT**是很流行的一种P2P应用。BT采用“**最稀有的优先**”的技术，可以尽早把最稀有的文件块收集到。
29. 在对等方的数量很大时，采用P2P方式下载大文件，要比传统的客户-服务器方式快得多。
30. 在P2P应用中，广泛使用的索引和查找技术是**分布式散列表DHT**。

## 第7章 网络安全

1. 计算机网络上的通信面临的威胁可分为两大类，即被动攻击和主动攻击。
2. **对称密钥密码体制**是加密密钥与解密密钥相同的密码体制（如数据加密标准DES和高级加密标准AES）。这种加密的保密性仅取决于对密钥的保管，而算法是公开的。
3. **公钥密码体制**（又称为公开密钥密码体制）使用不同的加密密钥与解密密钥。加密密钥（即公钥）是向公众开放的，而解密密钥（即私钥或秘钥）则是需要保密的。加密算法和解密算法也是公开的。
4. 目前最著名的公钥密码体制是**RSA体制**，它是基于数论中的大数分解问题的体制。
5. 任何加密方法的安全性取决于**密钥的长度**，以及**攻破密文所需的计算量**。
6. 数字签名必须保证能够实现以下三点功能：（1）报文鉴别，即接收者能够核实发送者对报文的签名（2）报文的完整性（3）不可否认
7. **报文摘要MD**是进行报文鉴别的一种简单方法，目前广泛使用的是**SHA-1**。
8. 密钥管理包括：**密钥的产生**、**分配**、**注入 **、**验证**和**使用**。密钥分配（或密钥分发）是密钥管理中最大的问题。密钥必须通过最安全的通路进行分配。目前常用的密钥分配方式是**设立密钥分配中心KDC**。

## 第8章 互联网上的音频/视频服务

1. 多媒体信息的两个重要特点：（1）多媒体信息的信息量往往很大；（2）在传输多媒体数据时，对时延和时延抖动均有较高的要求。
2. 目前互联网提供的音频/视频服务有三种类型：（1）**流体存储音频/视频**，用户通过互联网边下载、边播放。（2）**流式实况音频/视频**，在发送方边录制、边发送，在接受时也要求能够连续播放。（3）**交互式音频/视频**，如互联网电话或互联网电视会议。
3. 流媒体就是**流式音频/视频**，特点是边下载、边伯范，但不能存储为硬盘上称为用户的文件。对于实时流式音频/视频文件的传送应当选用**UDP**。
4. 实时流式协议RTSP是为了给流式过程增加更多功能而设计的协议。RTSP本身并不传送数据，而仅仅是使媒体播放器能够控制多媒体流的传送。RTSP又称为“互联网录像机遥控协议”。
5. IP电话的通话质量主要由两个因素决定：（1）通话双方端到端的时延和时延抖动；（2）话音分组的丢失率。

## 第9章 无线网络和移动网络

1. 无线局域网可分为两大类。第一类是有固定基础设施的，第二类是无固定基础设施的。
2. 无线局域网的标准是IEEE的**802.11**系列。使用802.11系列协议的局域网又称为Wi-Fi。
3. 802.11无线以太网标准使用**星形拓扑**，其中心叫做**接入点AP**，就是基本服务集内的基站。
4. 802.11无线以太网在MAC层使用**CSMA/CA**协议。使用CSMA/CA协议是为了尽量减小碰撞发生的概率。在使用CSMA/CA的同时，还使用停止等待协议。
5. 在802.11无线局域网的MAC帧首部中有一个**持续期**字段，用来填入**在本帧结束后**还要占用信道多少时间。802.11的MAC帧共有三种类型，即**控制帧**、**数据帧**、**管理帧**。MAC帧有四个地址字段，在有固定基础设施的无线局域网中，只使用其中的三个地址字段，即**源地址**、**目的地址**和**AP地址**。
6. 移动IP的路由选择有间接路由选择和直接路由选择，后者需要使用通信者代理和锚外地代理。
